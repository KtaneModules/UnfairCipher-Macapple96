
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Unfair Cipher — Keep Talking and Nobody Explodes Module</title>
    <meta name="viewport" content="initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <script src="js/highlighter.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Unfair Cipher.svg" class="diagram">
                <h2>On the Subject of Unfair Cipher</h2>
                <p class="flavour-text">It doesn’t play that fair anymore.</p>
                <p>This module has two displays. The display on top shows the encrypted message.</p>
                <p>The display on the right can be clicked to toggle between showing the Module ID, in white, or strikes the module keeping track of, in red.</p>
                <ul><li><i>Both of these are shown in Roman numerals!</i></li></ul>
                <p>The module encrypts a string of ten three letter long <em>instructions</em> with two <strong>Playfair Ciphers</strong>, using different <strong>keys</strong> for each. Enter the correct combination of inputs to disarm the module.</p>
                <ul><li>The order of encryptions is the following: <strong>Original -> Key A Encrypted -> Key C Encrypted -> Caesar Ciphered</strong>. Reverse the order to obtain the <strong>original</strong> instruction string.</li></ul>
                <h3>Key A</h3>
                <ol>
                    <li>Start with the bomb's serial number.</li>
                    <li>
                        Transform each letter into its numerical equivalent (A=1, B=2, etc.), <ul><li>Make a single string of digits.</li></ul>
                        <ul><li>Ignore the first character if its numerical equivalent is 20 or above</li></ul>
                    </li>
                    <li>
                        Remove the last digit if either the 4th or the 5th characters of the serial are <strong>vowels</strong>
                        <ul><li>You should only do this once, even in the case both characters are vowels.</li></ul>
                    </li>
                    <li>Convert this number into <strong><em>hexadecimal</em></strong>, refer to <i>Appendix D3K2H3X</i> for instructions.</li>
                    <li>
                        If the hexadecimal number has two digits in range 1 to 26 next to each other, transform them into the alphabetical equivalent. Otherwise, transform the single digits into their alphabetical equivalents.
                        <ul>
                            <li>
                                Delete all zeroes which don't have either 1 or 2 on their left.
                                <ul>
                                    <li><strong>(Ex.: 0129A -> LIA)</strong></li>
                                    <li><strong>(1029A -> JBIA)</strong></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>Transform the Module ID, the amount of Port Plates and the amount of Battery Holders into their alphabetical equivalents.</li>
                    <li>Append these three characters at the end of the result of the previous conversion.</li>
                    <li><strong>This is Key A.</strong></li>
                </ol>
            </div>
            <div class="page-footer relative-footer">Page 1 of 6</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher</span>
            </div>
            <div class="page-content">
                <h3>Key B</h3>
                <p>Key B is needed to obtain <strong>Key C</strong> from <strong>Key A</strong>.</p>
                <p>Obtain your initial Key B from the following table:</p>
                <table>
                    <tr>
                        <td bgcolor="#101010" colspan="2" rowspan="2"></td>
                        <th colspan="7" rowspan="1" bgcolor="#303030" style="color: white">Month (Jan - Jun)</th>
                    </tr>
                    <tr>
                        <th>Jan</th>
                        <th>Feb</th>
                        <th>Mar</th>
                        <th>Apr</th>
                        <th>May</th>
                        <th>Jun</th>
                    </tr>
                    <tr>
                        <th rowspan="7" colspan="1" bgcolor="#303030" style="color: white">Day</th>
                        <th>Mon</th>
                        <td>AB41</td>
                        <td>6522</td>
                        <td>DB83</td>
                        <td>B124</td>
                        <td>DB95</td>
                        <td>AFE6</td>
                    </tr>
                    <tr>
                        <th>Tue</th>
                        <td>AB42</td>
                        <td>6523</td>
                        <td>DB84</td>
                        <td>B125</td>
                        <td>DB96</td>
                        <td>AFE7</td>
                    </tr>
                    <tr>
                        <th>Wed</th>
                        <td>AB43</td>
                        <td>6524</td>
                        <td>DB85</td>
                        <td>B126</td>
                        <td>DB97</td>
                        <td>AFE8</td>
                    </tr>
                    <tr>
                        <th>Thu</th>
                        <td>AB44</td>
                        <td>6525</td>
                        <td>DB86</td>
                        <td>B127</td>
                        <td>DB98</td>
                        <td>AFE9</td>
                    </tr>
                    <tr>
                        <th>Fri</th>
                        <td>AB45</td>
                        <td>6526</td>
                        <td>DB87</td>
                        <td>B128</td>
                        <td>DB99</td>
                        <td>AFEA</td>
                    </tr>
                    <tr>
                        <th>Sat</th>
                        <td>AB46</td>
                        <td>6527</td>
                        <td>DB88</td>
                        <td>B129</td>
                        <td>DB9A</td>
                        <td>AFEB</td>
                    </tr>
                    <tr>
                        <th>Sun</th>
                        <td>AB47</td>
                        <td>6528</td>
                        <td>DB89</td>
                        <td>B12A</td>
                        <td>DB9B</td>
                        <td>AFEC</td>
                    </tr>
                </table>
                <table>
                    <tr>
                        <td bgcolor="#101010" colspan="2" rowspan="2"></td>
                        <th colspan="7" rowspan="1" bgcolor="#303030" style="color: white">Month (Jul - Dec)</th>
                    </tr>
                    <tr>
                        <th>Jul</th>
                        <th>Aug</th>
                        <th>Sep</th>
                        <th>Oct</th>
                        <th>Nov</th>
                        <th>Dec</th>
                    </tr>
                    <tr>
                        <th rowspan="7" colspan="1" bgcolor="#303030" style="color: white">Day</th>
                        <th>Mon</th>
                        <td>AFC7</td>
                        <td>C178</td>
                        <td>D5A9</td>
                        <td>FE1A</td>
                        <td>EFAB</td>
                        <td>453C</td>
                    </tr>
                    <tr>
                        <th>Tue</th>
                        <td>AFC8</td>
                        <td>C179</td>
                        <td>D5AA</td>
                        <td>FE1B</td>
                        <td>EFAC</td>
                        <td>453D</td>
                    </tr>
                    <tr>
                        <th>Wed</th>
                        <td>AFC9</td>
                        <td>C17A</td>
                        <td>D5AB</td>
                        <td>FE1C</td>
                        <td>EFAD</td>
                        <td>453E</td>
                    </tr>
                    <tr>
                        <th>Thu</th>
                        <td>AFCA</td>
                        <td>C17B</td>
                        <td>D5AC</td>
                        <td>FE1D</td>
                        <td>EFAE</td>
                        <td>453F</td>
                    </tr>
                    <tr>
                        <th>Fri</th>
                        <td>AFCB</td>
                        <td>C17C</td>
                        <td>D5AD</td>
                        <td>FE1E</td>
                        <td>EFAF</td>
                        <td>4540</td>
                    </tr>
                    <tr>
                        <th>Sat</th>
                        <td>AFCC</td>
                        <td>C17D</td>
                        <td>D5AE</td>
                        <td>FE1F</td>
                        <td>EFB0</td>
                        <td>4541</td>
                    </tr>
                    <tr>
                        <th>Sun</th>
                        <td>AFCD</td>
                        <td>C17E</td>
                        <td>D5AF</td>
                        <td>FE20</td>
                        <td>EFB1</td>
                        <td>4542</td>
                    </tr>
                </table>
                <p>If your initial Key B has numbers, transform them in their <strong>alphabetical equivalent</strong>, using the <strong>same</strong> rules applied for Key A.</p>
                <h3>Key C</h3>
                <p>To obtain Key C, Playfair encipher Key A using Key B as a <b>Keyword</b>.</p>
                <p>Refer to <i>Appendix PL4YF4112 101</i> for instructions.</p>
                <p>The result of such encryption is <strong>Key C</strong>.</p>
            </div>
            <div class="page-footer relative-footer">Page 2 of 6</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Appendix Name</span>
            </div>
            <div class="page-content">
                <h3 style="color:red"> Read onwards only once you have all three keys, which should be ALPHABETICAL characters. </h3>
                <p>You're all set to decipher the instructions. The first cipher to solve is a simple Caesar Cipher.</p>
                <h4>Solving - Step 1: Caesar Cipher</h4>
                <p>To calculate the offset used for the Caesar Cipher use the following table:</p>
                <table>
                    <tr>
                        <td bgcolor="#101010"></td>
                        <th bgcolor="#303030" style="color: white">Offset&nbsp; + Add &nbsp; - Subtract</th>
                    </tr>
                    <tr>
                        <td>For every <em>distinct</em> port <strong><em>type</em></strong></td>
                        <th>− 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>port plate</strong></td>
                        <th>+ 1</th>
                    </tr>
                    <tr>
                        <td>For every <strong>consonant</strong> in the serial number</td>
                        <th>+ 1</th>
                    </tr>
                    <tr>
                        <td>For every <strong>vowel</strong> in the serial number</td>
                        <th>− 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>on</strong> indicator</td>
                        <th>+ 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>off</strong> indicator</td>
                        <th>- 2</th>
                    </tr>
                    <tr>
                        <td>For every <strong>battery</strong></td>
                        <th>− 1</th>
                    </tr>
                </table>
                <p>Finalize your offset by checking if any of these conditions apply. (Always drop any remainder, <strong>13/2 = 6</strong>)</p>
                <table>
                    <tr>
                        <th bgcolor="#303030" style="color: white">Condition</th>
                        <th bgcolor="#303030" style="color: white">Operation</th>
                    </tr>
                    <tr>
                        <td>No batteries</td>
                        <th>− 10</th>
                    </tr>
                    <tr>
                        <td>No ports</td>
                        <th>× 2</th>
                    </tr>
                    <tr>
                        <td>31 or more modules</td>
                        <th>÷ 2</th>
                    </tr>
                </table>
                <p>This is the offset used in the Caesar Cipher. To <em>decipher</em> it, shift every letter on the screen by <strong>X</strong> letters forwards if the offset is negative, backwards if positive.</p>
                <p>Wrap back to the other side of the alphabet if you have to go backwards from <strong>A</strong> or forwards from <strong>Z</strong>.</p>
                <h4>Solving - Step 2: Playfairs</h4>
                <p>Playfair decrypt the string you just deciphered using Key C as a keyword.</p>
                <p>Repeat this process using Key A as a keyword.</p>
                <h5>You now have the original message, congratulations.</h5>
            </div>
            <div class="page-footer relative-footer">Page 3 of 6</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Appendix Name</span>
            </div>
            <div class="page-content">

                <h2>Solving - Step 3: Executing the Instructions</h2>
                <ul>
                    <li>The message consists of 10 instructions, each with potentially different inputs required. Execute the instructions left to right.</li>
                    <li>
                        Unlike Playfair Cipher, getting a strike anywhere on the bomb <em>won't change the answer you worked VERY hard on</em>.
                        <ul>
                            <li>However, striking <em>anywhere</em> on the bomb <strong>WILL</strong> affect some inputs.</li>
                        </ul>
                    </li>
                    <li>
                        Tap the small screen on the right to toggle between showing Module ID or Strikes. Strikes are shown in red. Both of these are in roman numerals.
                        <ul>
                            <li style="color:red">The module counts strikes coming from EVERY module on the bomb, not only itself.</li>
                            <li style="color:red"><em>The module can keep track of strikes even in Time Mode!</em></li>
                        </ul>
                    </li>
                </ul>
                <h4>Instructions:</h4>
                <p>'%' refers to the modulo (remainder) operation.</p>
                <ul>
				<li>PCR: Press the Red button.</li>
				<li>PCG: Press the Green button</li>
				<li>PGB: Press the Blue button</li>
                    <li>
                        SUB or MIT: Press Inner/Outer center...
                        <ul>
                            <li>If SUB: Press <strong>Outer Center</strong> when the seconds digits on the timer match.</li>
                            <li>If MIT: Press <strong>Inner Center</strong> when the seconds on the timer match <i><code>(m + c) % 60</code></i>, with <i>m</i> being the Module ID, and <i>c</i> being the number a colored (R, G, B) button has been pressed since the last strike on this module.</li>
							<ul>
							<li>"MIT" will accept inputs up to 2 seconds early or late</li>
							</ul>
                        </ul>
                    </li>
                    <li>
                        PRN or CHK:
                        <ul>
                            <li>If PRN: Press <strong>Inner Center</strong> if Module ID % 20 is a prime number; Otherwise, press Outer Center.</li>
                            <li>If CHK: Press <strong>Outer Center</strong> if Module ID % 20 is a prime number; Otherwise, press Inner Center.</li>
                            <li><h5>Refer to <i>Appendix PR1M3</i> for a list of prime numbers.</h5></li>
                        </ul>
                    </li>
                    <li>
                        BOB: Press <strong>Inner Center</strong>
                        <ul>
                            <li>If there is a lit BOB as the only indicator on the bomb and two batteries in total, this <strong>instantly solves the module!</strong></li>
                        </ul>
                    </li>
                    <li>
                        REP or EAT: Repeat the last input.
                        <ul>
                            <li>If this comes out as first instruction, press <strong>Inner Center</strong></li>
                        </ul>
                    </li>
                    <li>
                        STR or IKE: Starting from <span style="color:red">Red</span> (0), the colored button on top, count as many colored buttons clockwise as there are strikes and press the resulting button.
                    </li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 4 of 6</div>
        </div>
        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher Appendix</span>
            </div>
            <div class="page-content">
                <h3>Appendix - D3K2H3X</h3>
                <p>Follow these steps to convert any integer into an hexadecimal number:</p>
                <ol>
                    <li>Divide the decimal number by 16</li>
                    <li>Keep the quotient of such division aside for the next iteration.</li>
                    <li>Convert the integer remainder of such division into the HEX digit using the table below.</li>
                    <li>Repeat steps 1 to 3 until the quotient is zero.</li>
                    <li>
                        The HEX number is read backwards, starting from the "quotient zero" operation.
                        <ul>
                            <li>Neglect the zero if it's the first digit.</li>
                        </ul>
                    </li>
                </ol>
                <table>
                    <tr>
                        <th>DEC</th>
                        <th>HEX</th>
                    </tr>
                    <tr>
                        <th>0 - 9</th>
                        <th>0 - 9</th>
                    </tr>
                    <tr>
                        <th>10</th>
                        <th>A</th>
                    </tr>
                    <tr>
                        <th>11</th>
                        <th>B</th>
                    </tr>
                    <tr>
                        <th>12</th>
                        <th>C</th>
                    </tr>
                    <tr>
                        <th>13</th>
                        <th>D</th>
                    </tr>
                    <tr>
                        <th>14</th>
                        <th>E</th>
                    </tr>
                    <tr>
                        <th>15</th>
                        <th>F</th>
                    </tr>
                    <tr>
                        <th>16</th>
                        <th>10</th>
                    </tr>
                    <tr>
                        <th>26</th>
                        <th>1A</th>
                    </tr>
                    <tr>
                        <th>...</th>
                        <th>...</th>
                    </tr>
                </table>

            </div>
            <div class="page-footer relative-footer">Page 5 of 6</div>
        </div>
        <div class="page page-bg-06">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Unfair Cipher Appendix</span>
            </div>
            <div class="page-content">
                <h3>Appendix - PL4YF4112 101</h3>
                <ul>
                    <li>
                        Create a a 5×5 matrix of letters. Start with your <b>keyword</b>
                        and fill the rest with the unused letters of the alphabet.
                        Each letter must occur only <b>once</b> in the matrix, so only add the first occurrence.
                        ‘J’ and ‘I’ are interchangeable.
                    </li>
                    <li>
                        <div>
                            Split the <b>message</b> into character pairs. <em>If you cannot form a pair, add an <strong>'X'</strong><em>. For each pair:
                            <h5>If DECRYPTING:</h5>
                            <ul>
                                <li>If the letters appear on the same row of your matrix, replace them with the letters to their immediate left respectively, wrapping around to the right side of the row if necessary.</li>
                                <li>If the letters are on the same column of your matrix, replace them with the letters immediately above, wrapping to the bottom if necessary.</li>
                                <li>If the letters are on different rows and columns, replace each of them with the letter on the same row but in the column of the other letter in the original pair.</li>
                            </ul>
                            <h5>If ENCRYPTING:</h5>
                            <ul>
                                <li>If the letters appear on the same row of your matrix, replace them with the letters to their immediate right respectively, wrapping around to the left side of the row if necessary.</li>
                                <li>If the letters are on the same column of your matrix, replace them with the letters immediately below, wrapping to the top if necessary.</li>
                                <li>If the letters are on different rows and columns, replace each of them with the letter on the same row but in the column of the other letter in the original pair.</li>
                            </ul>
                        </div>
                    </li>
                    <li>Drop any Xs that don’t make sense and locate any Is that should be Js.</li>
                </ul>
                <h3>Appendix - PR1M3</h3>
                <ul>
                    <li>Prime Numbers (to 20): 2, 3, 5, 7, 11, 13, 17, 19</li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 6 of 6</div>
        </div>
    </div>
</body>
</html>